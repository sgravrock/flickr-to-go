#!/usr/bin/env ruby
require 'flickraw'
require_relative '../lib/flickr-to-go/session'
require_relative '../lib/flickr-to-go/console_auth_ui_adapter'

def require_env(name)
	value = ENV[name]

	if value.nil? || value.empty?
		$stderr.puts("Please set the #{name} environment variable.")
		exit(1)
	end

	value
end

FlickRaw.api_key = require_env('FLICKR_API_KEY')
FlickRaw.shared_secret = require_env('FLICKR_API_SECRET')
adapter = FlickrToGo::ConsoleAuthUiAdapter.new
session = FlickrToGo::Session.new(flickr, adapter)
session.authorize
login = flickr.test.login
puts "Username: #{login.username}"
puts "Access token: #{flickr.access_token}"
puts "Secret: #{flickr.access_secret}"

